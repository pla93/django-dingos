{% extends "dingos/grappelli/lists/base_lists_one_column.html" %}

{% comment %}
Copyright (c) Siemens AG, 2014

This file is part of MANTIS.  MANTIS is free software: you can
redistribute it and/or modify it under the terms of the GNU General Public
License as published by the Free Software Foundation; either version 2
of the License, or(at your option) any later version.

This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
details.

You should have received a copy of the GNU General Public License along with
this program; if not, write to the Free Software Foundation, Inc., 51
Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
{% endcomment %}

{% load dingos_tags %}


{% block content_title %}
    <h1>Custom Info Object Search</h1>
{% endblock %}

{% block list-tools %}
    <form id="query-executor" action="" method="get">{% csrf_token %}
        {% if placeholder_form %}
            <div class="grp-row grp-collapse grp-opened">
                <h3 class="grp-collapse-handler">Placeholders</h3>
                {{ placeholder_form.as_p }}
            </div>
        {% endif %}
        <div class="grp-row grp-collapse {% if placeholder_form %}grp-closed{% else %}grp-opened{% endif %}">
            <h3 class="grp-collapse-handler">Query</h3>
            {{ form.query }}
        </div>
        <div class="grp-row">
            Paginate by {{ form.paginate_by }} {{ form.page }}
        </div>
        <div class="grp-row">
            <input type="submit" name="execute_query" value="Execute query" />
            <input name="action" value="Save Search" type="submit" />
        </div>
    </form>
{% endblock %}

{% block objects %}
    {% if object_list %}
        <div class="grp-module grp-changelist-results">

            <table id="result_list" cellspacing="0" class="grp-sortable">
                {% block header_row %}
                    <thead>
                        <tr>
                            {% include "dingos/grappelli/includes/CheckboxActionHeaderColumn.html" %}

                            {% for col_header in col_headers %}
                            <th scope="col" class="sortable column-identifier"><div class="grp-text">
                                <a href="#" onclick="return false;">{{ col_header }}</a>
                            </div></th>
                            {% endfor %}
                            <th scope="col"></th>
                        </tr>
                    </thead>
                {% endblock %}

                {% block rows %}
                    <tbody>
                        {% for obj in object_list %}
                            <tr class="grp-row grp-row-{% cycle 'odd' 'even' %}">

                                {% include "dingos/grappelli/includes/CheckboxActionColumn.html" %}

                                {% for selected_col in selected_cols %}

                                    <td>
                                        {% show_InfoObjectField obj selected_col %}
                                    </td>
                                {% endfor %}
                                <td>
                                    <a href="{%url 'url.dingos.view.infoobject' pk=obj.pk %}">View</a>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                {% endblock %}
            </table>

        </div>
    {%  endif %}
{% endblock %}
