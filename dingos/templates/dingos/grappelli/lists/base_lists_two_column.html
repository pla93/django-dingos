{% extends "dingos/grappelli/base.html" %}

{% comment %}
Copyright (c) Siemens AG, 2013

This file is part of MANTIS.  MANTIS is free software: you can
redistribute it and/or modify it under the terms of the GNU General Public
License as published by the Free Software Foundation; either version 2
of the License, or(at your option) any later version.

This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
details.

You should have received a copy of the GNU General Public License along with
this program; if not, write to the Free Software Foundation, Inc., 51
Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
{% endcomment %}






{% load dingos_tags %}

{% block extrahead %}

{% endblock %}


{% block content %}

    <div class= {% if customization.horizontal.dingos.view.orientation != 'horizontal' %}
                ""
                {% else %}
                "l-2cr-fluid l-d-12"

                {% endif %}
            >
        <div class="c-1">

            <div class="grp-module">
                <h2>{% block tool_title %}Filter Parameters {% endblock %}</h2>
                {%  block list-tools %}
                    {% if filter.form %}
                        <div class="grp-row">

                            <form action="" method="get">
                                <table>
                                  <tbody>
                                    {% for field in filter.form %}
                                      {% if not field.id_for_label == 'id_o' %}
				        <tr>
                                          <th>{{field.label_tag}}</th>
                                          <td>{{field.errors}} {{field}}</td>
                                        </tr>
                                      {% endif %}
                                    {% endfor %}
                                  </tbody>
                                </table>
				<div style="padding-top:10px;text-align:right;">
                                  <input name="action" value="Submit Query" type="submit" />
                                  <input name="action" value="Save Search" type="submit" />
                                </div>
                            </form>
                        </div>
                    {% endif %}
                {% endblock %}

            </div>
        </div>
        <div class="c-2">
            {% block frontmatter %}
            {% endblock frontmatter %}
            <div class="grp-module">
            <h2 class="grp-collapse-handler">{% block list_title %}Object List {% endblock %}</h2>

            {%  if is_paginated %}
                {%  render_paginator  %}
            {% endif %}

            {% block objects %}
        {% endblock %}
            {%  if is_paginated %}
                {%  render_paginator  %}
            {% endif %}
            </div>
        </div>



        </div>

    </div>

  {% if list_actions %}
  <script charset="utf-8" type="text/javascript">

    // CHANGE HERE TO ENABLE USER-SETTING BASED BEHAVIOR
    var _enable_button = true;

    // button-based
    if ( _enable_button ) {

      (function($) {
        $(document).on('click', '#action-submit, :button', function() {
          var action = $("#action-target");
          if ( action.val() != "") {
            var form = $("#action-form");
            if($('input[type="checkbox"]:checked', form).length > 1) {
              form.attr("action", action.val());
              form.submit();
              return true;
            }
          return false;
          }
        });
      })(grp.jQuery);

    }

    // grappelli standard
    else {

      (function($) {
        $(document).ready(function() {
          $('#action-submit-row').hide();
        });
      })(grp.jQuery);

      (function($) {
        $(document).on('change', '#action-target', function() {
          var _this = this;
          if ( $(_this).val() != "") {
            var form = $("#action-form");
            if($('input[type="checkbox"]:checked', form).length == 0){
	      $(_this).val("");
	     return false;
            }
            form.attr("action", $(_this).val());
            form.submit();
          }
        });
      })(grp.jQuery);

  }
  </script>
  <footer class="grp-module grp-submit-row grp-fixed-footer" id="submit">
     <header style="display:none"><h1>Submit Options</h1></header>
     <ul>
       <li class="grp-float-left grp-changelist-actions">
         <div class="grp-changelist-actions">
           <select name="action" autocomplete="off" id="action-target">
             <option selected="selected" value="">---------</option>
             {% for action in list_actions %}
               <option value="{% url action.1 %}">{{action.0}}</option>
             {% endfor %}
           </select>
           <input type="hidden" value="0" name="select_across" class="select-across">
           <script type="text/javascript">var _actions_icnt="{{ request.session.customization.dingos.view.pagination.lines }}";</script>
           <ul class="grp-horizontal-list grp-float-left">
             <li class="grp-action-counter"><span class="grp-button grp-button-state-inactive grp-action-counter">0 of {{ request.session.customization.dingos.view.pagination.lines }} selected</span></li>
           </ul>
         </div>
      </li>
      <li id="action-submit-row"><input class="grp-button grp-default" type="button" value="Submit" id="action-submit"></li>
    </ul>
   
  </footer>
  {% endif %}
 

{% endblock %}
